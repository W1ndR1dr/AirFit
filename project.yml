name: AirFit
options:
  bundleIdPrefix: com.airfit
  deploymentTarget:
    iOS: "18.0"
    watchOS: "11.0"
  developmentLanguage: en
  xcodeVersion: "16.0"

settings:
  SWIFT_VERSION: "6.0"
  IPHONEOS_DEPLOYMENT_TARGET: "18.0"
  WATCHOS_DEPLOYMENT_TARGET: "11.0"
  ENABLE_STRICT_CONCURRENCY: YES
  SWIFT_STRICT_CONCURRENCY: complete

packages:
  WhisperKit:
    url: https://github.com/argmaxinc/WhisperKit.git
    from: "0.9.0"

targets:
  AirFit:
    type: application
    platform: iOS
    sources:
      - path: AirFit
        includes:
          - "**/*.swift"
        excludes:
          - "**/*.md"
          - "**/.*"
          - "AirFitTests/**"
          - "AirFitUITests/**"
      - AirFit/Modules/Onboarding/Models/OnboardingModels.swift
      - AirFit/Modules/Onboarding/Models/ConversationTypes.swift
      - AirFit/Modules/Onboarding/Models/PersonalityInsights.swift
      - AirFit/Modules/Onboarding/ViewModels/OnboardingViewModel.swift
      - AirFit/Modules/Onboarding/ViewModels/ConversationViewModel.swift
      - AirFit/Modules/Onboarding/Views/OnboardingFlowView.swift
      - AirFit/Modules/Onboarding/Views/ConversationView.swift
      - AirFit/Modules/Onboarding/Views/LifeSnapshotView.swift
      - AirFit/Modules/Onboarding/Views/OpeningScreenView.swift
      - AirFit/Modules/Onboarding/Views/CoachProfileReadyView.swift
      - AirFit/Modules/Onboarding/Views/CoreAspirationView.swift
      - AirFit/Modules/Onboarding/Views/EngagementPreferencesView.swift
      - AirFit/Modules/Onboarding/Views/GeneratingCoachView.swift
      - AirFit/Modules/Onboarding/Views/OnboardingNavigationButtons.swift
      - AirFit/Modules/Onboarding/Views/MotivationalAccentsView.swift
      - AirFit/Modules/Onboarding/Views/SleepAndBoundariesView.swift
      - AirFit/Modules/Onboarding/Views/HealthKitAuthorizationView.swift
      - AirFit/Modules/Onboarding/Views/CoachingStyleView.swift
      - AirFit/Modules/Onboarding/Views/PersonaSelectionView.swift  # Phase 4: New persona selection UI
      - AirFit/Modules/Onboarding/Views/ConversationalInputView.swift
      - AirFit/Modules/Onboarding/Views/InputModalities/TextInputView.swift
      - AirFit/Modules/Onboarding/Views/InputModalities/VoiceInputView.swift
      - AirFit/Modules/Onboarding/Views/InputModalities/VoiceVisualizer.swift
      - AirFit/Modules/Onboarding/Views/InputModalities/ChoiceCardsView.swift
      - AirFit/Modules/Onboarding/Views/InputModalities/ContextualSlider.swift
      - AirFit/Modules/Onboarding/Views/ConversationProgress.swift
      - AirFit/Modules/Onboarding/Views/PersonaSynthesisView.swift
      - AirFit/Modules/Onboarding/Views/PersonaPreviewCard.swift
      - AirFit/Modules/Onboarding/Views/PersonaPreviewView.swift
      - AirFit/Modules/Onboarding/Views/OnboardingContainerView.swift
      - AirFit/Modules/Onboarding/Views/UnifiedOnboardingView.swift
      - AirFit/Modules/Onboarding/Views/OnboardingStateView.swift
      - AirFit/Modules/Onboarding/Views/OptimizedGeneratingPersonaView.swift
      - AirFit/Modules/Onboarding/Views/OnboardingErrorBoundary.swift
      - AirFit/Modules/Onboarding/Views/FinalOnboardingFlow.swift
      - AirFit/Modules/Onboarding/Services/OnboardingService.swift
      - AirFit/Core/Protocols/OnboardingServiceProtocol.swift
      - AirFit/Modules/Onboarding/Services/ConversationFlowManager.swift
      - AirFit/Modules/Onboarding/Services/ResponseAnalyzer.swift
      - AirFit/Modules/Onboarding/Services/ConversationPersistence.swift
      - AirFit/Modules/Onboarding/Services/ConversationAnalytics.swift
      - AirFit/Modules/Onboarding/Services/OnboardingOrchestrator.swift
      - AirFit/Modules/Onboarding/Services/OnboardingState.swift
      - AirFit/Modules/Onboarding/Services/OnboardingRecovery.swift
      - AirFit/Modules/Onboarding/Services/OnboardingProgressManager.swift
      - AirFit/Modules/Onboarding/Services/PersonaService.swift
      - AirFit/Modules/Onboarding/Coordinators/OnboardingCoordinator.swift
      - AirFit/Modules/Onboarding/Coordinators/OnboardingFlowCoordinator.swift
      - AirFit/Modules/Onboarding/Coordinators/ConversationCoordinator.swift
      - AirFit/Modules/Onboarding/Data/ConversationFlowData.swift
      # Data Layer Models (CRITICAL: XcodeGen nesting bug)
      - AirFit/Data/Models/OnboardingProfile.swift
      - AirFit/Data/Models/User.swift
      - AirFit/Data/Models/CoachMessage.swift
      - AirFit/Data/Models/FoodEntry.swift
      - AirFit/Data/Models/FoodItem.swift
      - AirFit/Data/Models/MealTemplate.swift
      - AirFit/Data/Models/FoodItemTemplate.swift
      - AirFit/Data/Models/WorkoutTemplate.swift
      - AirFit/Data/Models/HealthKitSyncRecord.swift
      - AirFit/Data/Models/Workout.swift
      - AirFit/Data/Models/DailyLog.swift
      - AirFit/Data/Models/ChatMessage.swift
      - AirFit/Data/Models/ChatAttachment.swift
      - AirFit/Data/Models/Exercise.swift
      - AirFit/Data/Models/ConversationResponse.swift
      - AirFit/Data/Models/ConversationSession.swift
      - AirFit/Data/Models/ExerciseTemplate.swift
      - AirFit/Data/Models/ExerciseSet.swift
      - AirFit/Data/Models/NutritionData.swift
      - AirFit/Data/Models/ChatSession.swift
      - AirFit/Data/Models/ConversationSession.swift
      - AirFit/Data/Models/ConversationResponse.swift
      - AirFit/Data/Models/SetTemplate.swift
      # Data Layer Extensions & Managers (CRITICAL: XcodeGen nesting bug)
      - AirFit/Data/Extensions/FetchDescriptor+Extensions.swift
      - AirFit/Data/Extensions/ModelContainer+Testing.swift
      - AirFit/Data/Managers/DataManager.swift
      - AirFit/Data/Migrations/SchemaV1.swift
      # Core Layer Files (CRITICAL: XcodeGen nesting bug)
      - AirFit/Core/Constants/APIConstants.swift
      - AirFit/Core/Constants/AppConstants.swift
      - AirFit/Core/Enums/GlobalEnums.swift
      - AirFit/Core/Enums/AppError.swift
      - AirFit/Core/Enums/MessageType.swift
      - AirFit/Core/Models/HealthContextSnapshot.swift
      - AirFit/Core/Models/WorkoutBuilderData.swift
      - AirFit/Core/Models/AI/AIModels.swift
      - AirFit/Modules/AI/Models/DirectAIModels.swift
      - AirFit/Modules/AI/Models/NutritionParseResult.swift
      - AirFit/Core/Models/NutritionPreferences.swift
      - AirFit/Core/Extensions/String+Extensions.swift
      - AirFit/Core/Extensions/View+Extensions.swift
      - AirFit/Core/Extensions/Color+Extensions.swift
      - AirFit/Core/Extensions/Date+Extensions.swift
      - AirFit/Core/Extensions/Double+Extensions.swift
      - AirFit/Core/Extensions/TimeInterval+Extensions.swift
      - AirFit/Core/Utilities/AppState.swift
      - AirFit/Core/Utilities/DependencyContainer.swift
      - AirFit/Core/Utilities/HapticManager.swift
      - AirFit/Core/Utilities/KeychainWrapper.swift
      - AirFit/Core/Utilities/AppLogger.swift
      - AirFit/Core/Utilities/Formatters.swift
      - AirFit/Core/Utilities/Validators.swift
      - AirFit/Core/Utilities/HealthKitAuthManager.swift
      - AirFit/Core/Utilities/PersonaMigrationUtility.swift  # Phase 4: Blend to PersonaMode migration
      - AirFit/Core/Utilities/NetworkReachability.swift  # Phase 4: Network monitoring
      - AirFit/Core/Utilities/NetworkReachability.swift  # Batch 4.3: Network monitoring
      - AirFit/Core/Theme/AppShadows.swift
      - AirFit/Core/Theme/AppSpacing.swift
      - AirFit/Core/Theme/AppColors.swift
      - AirFit/Core/Theme/AppFonts.swift
      - AirFit/Core/Views/CommonComponents.swift
      - AirFit/Core/Views/ErrorPresentationView.swift  # Phase 4: Error handling UI
      - AirFit/Core/Views/ErrorPresentationView.swift  # Batch 4.3: Error presentation
      - AirFit/Core/Protocols/ViewModelProtocol.swift
      - AirFit/Core/Protocols/ServiceProtocol.swift
      - AirFit/Core/Protocols/AIServiceProtocol.swift
      - AirFit/Core/Protocols/APIKeyManagementProtocol.swift
      - AirFit/Core/Protocols/NetworkManagementProtocol.swift
      - AirFit/Core/Protocols/WeatherServiceProtocol.swift
      - AirFit/Core/Protocols/WorkoutServiceProtocol.swift
      - AirFit/Core/Protocols/AnalyticsServiceProtocol.swift
      - AirFit/Core/Protocols/GoalServiceProtocol.swift
      - AirFit/Core/Models/ServiceTypes.swift
      - AirFit/Services/Speech/WhisperModelManager.swift
      - AirFit/Services/Speech/VoiceInputManager.swift
      # Services Layer Files (CRITICAL: XcodeGen nesting bug)
      - AirFit/Services/Security/DefaultAPIKeyManager.swift
      - AirFit/Services/Network/NetworkClient.swift
      - AirFit/Core/Protocols/NetworkClientProtocol.swift
      - AirFit/Core/Protocols/UserServiceProtocol.swift
      - AirFit/Services/User/DefaultUserService.swift
      - AirFit/Core/Protocols/WhisperServiceWrapperProtocol.swift
      - AirFit/Services/AI/ProductionAIService.swift
      - AirFit/Services/AI/SimpleMockAIService.swift
      - AirFit/Core/Protocols/LLMProvider.swift
      - AirFit/Services/AI/LLMProviders/LLMModels.swift
      - AirFit/Services/AI/LLMProviders/AnthropicProvider.swift
      - AirFit/Services/AI/LLMProviders/OpenAIProvider.swift
      - AirFit/Services/AI/LLMProviders/GeminiProvider.swift
      - AirFit/Services/AI/LLMOrchestrator.swift
      - AirFit/Services/AI/AIResponseCache.swift
      - AirFit/Modules/AI/Parsing/LocalCommandParser.swift
      - AirFit/Modules/AI/Functions/FunctionRegistry.swift
      - AirFit/Modules/AI/Functions/WorkoutFunctions.swift
      - AirFit/Modules/AI/Functions/NutritionFunctions.swift
      - AirFit/Modules/AI/Functions/AnalysisFunctions.swift
      - AirFit/Modules/AI/Functions/GoalFunctions.swift
      - AirFit/Modules/AI/Functions/FunctionCallDispatcher.swift
      - AirFit/Modules/AI/PersonaEngine.swift
      - AirFit/Modules/AI/Models/PersonaMode.swift  # Phase 4: Discrete persona modes
      - AirFit/Modules/AI/ConversationManager.swift
      - AirFit/Modules/AI/CoachEngine.swift
      - AirFit/Modules/AI/ContextAnalyzer.swift
      - AirFit/Modules/AI/WorkoutAnalysisEngine.swift
      - AirFit/Modules/AI/PersonaSynthesis/PersonaSynthesizer.swift
      - AirFit/Modules/AI/PersonaSynthesis/OptimizedPersonaSynthesizer.swift
      - AirFit/Modules/AI/PersonaSynthesis/FallbackPersonaGenerator.swift  # Phase 4: Error recovery
      - AirFit/Modules/AI/PersonaSynthesis/PreviewGenerator.swift
      - AirFit/Modules/AI/Models/PersonaModels.swift
      - AirFit/Modules/AI/Models/ConversationPersonalityInsights.swift
      - AirFit/Modules/AI/Configuration/RoutingConfiguration.swift
      - AirFit/Core/Protocols/DashboardServiceProtocols.swift
      - AirFit/Modules/Dashboard/Services/DefaultHealthKitService.swift
      - AirFit/Modules/Dashboard/Services/DefaultAICoachService.swift
      - AirFit/Modules/Dashboard/Services/DefaultDashboardNutritionService.swift
      - AirFit/Modules/Dashboard/Models/DashboardModels.swift
      - AirFit/Modules/Dashboard/Coordinators/DashboardCoordinator.swift
      - AirFit/Modules/Dashboard/ViewModels/DashboardViewModel.swift
      - AirFit/Modules/Dashboard/Views/DashboardView.swift
      - AirFit/Modules/Dashboard/Views/Cards/MorningGreetingCard.swift
      - AirFit/Modules/Dashboard/Views/Cards/NutritionCard.swift
      - AirFit/Modules/Dashboard/Views/Cards/RecoveryCard.swift
      - AirFit/Modules/Dashboard/Views/Cards/PerformanceCard.swift
      - AirFit/Modules/Dashboard/Views/Cards/QuickActionsCard.swift
      - AirFit/Services/Health/HealthKitManager.swift
      - AirFit/Core/Protocols/HealthKitManagerProtocol.swift
      - AirFit/Services/Health/HealthKitDataFetcher.swift
      - AirFit/Services/Health/HealthKitSleepAnalyzer.swift
      - AirFit/Services/Health/HealthKitDataTypes.swift
      - AirFit/Services/Health/HealthKitExtensions.swift
      - AirFit/Services/Context/ContextAssembler.swift
      - AirFit/Services/WorkoutSyncService.swift
      - AirFit/Services/ExerciseDatabase.swift
      - AirFit/Services/Monitoring/ProductionMonitor.swift
      - AirFit/Services/Cache/OnboardingCache.swift
      - AirFit/Services/Network/RequestOptimizer.swift
      - AirFit/Services/Network/NetworkManager.swift
      # ServiceProtocols.swift removed - protocols moved to Core/Protocols
      - AirFit/Services/ServiceConfiguration.swift
      - AirFit/Services/ServiceRegistry.swift
      - AirFit/Services/Security/KeychainHelper.swift
      - AirFit/Services/WeatherService.swift
      - AirFit/Services/AI/AIResponseParser.swift
      - AirFit/Services/AI/AIRequestBuilder.swift
      - AirFit/Core/Extensions/URLRequest+Extensions.swift
      - AirFit/Core/Extensions/AIProvider+Extensions.swift
      - AirFit/Modules/Workouts/ViewModels/WorkoutViewModel.swift
      - AirFit/Modules/Workouts/Coordinators/WorkoutCoordinator.swift
      - AirFit/Modules/Workouts/Models/WorkoutModels.swift
      - AirFit/Modules/Workouts/Views/WorkoutListView.swift
      - AirFit/Modules/Workouts/Views/WorkoutDetailView.swift
      - AirFit/Modules/Workouts/Views/ExerciseLibraryView.swift
      - AirFit/Modules/Workouts/Views/ExerciseLibraryComponents.swift
      - AirFit/Modules/Workouts/Views/TemplatePickerView.swift
      - AirFit/Modules/Workouts/Views/WorkoutBuilderView.swift
      - AirFit/Modules/Workouts/Views/AllWorkoutsView.swift
      - AirFit/Modules/Workouts/Views/WorkoutStatisticsView.swift
      - AirFit/Modules/Chat/Coordinators/ChatCoordinator.swift
      - AirFit/Modules/Chat/Models/ChatModels.swift
      - AirFit/Modules/Chat/Services/ChatSuggestionsEngine.swift
      - AirFit/Modules/Chat/Services/ChatExporter.swift
      - AirFit/Modules/Chat/Services/ChatHistoryManager.swift
      - AirFit/Modules/Chat/ViewModels/ChatViewModel.swift
      - AirFit/Modules/Chat/Views/MessageBubbleView.swift
      - AirFit/Modules/Chat/Views/MessageComposer.swift
      - AirFit/Modules/Chat/Views/VoiceSettingsView.swift
      - AirFit/Modules/Chat/Views/ChatView.swift
      # Settings Module Files (Module 11 - CRITICAL: XcodeGen nesting bug)
      - AirFit/Modules/Settings/Coordinators/SettingsCoordinator.swift
      - AirFit/Modules/Settings/Models/SettingsModels.swift
      - AirFit/Modules/Settings/Models/AIProviderExtensions.swift
      - AirFit/Modules/Settings/Models/PersonaSettingsModels.swift
      - AirFit/Modules/Settings/Models/UserSettingsExtensions.swift
      - AirFit/Modules/Settings/Services/BiometricAuthManager.swift
      - AirFit/Modules/Settings/Services/UserDataExporter.swift
      - AirFit/Modules/Settings/Services/NotificationManagerExtensions.swift
      - AirFit/Modules/Settings/ViewModels/SettingsViewModel.swift
      - AirFit/Modules/Settings/Views/SettingsListView.swift
      - AirFit/Modules/Settings/Views/Components/SettingsComponents.swift
      - AirFit/Modules/Settings/Views/AIPersonaSettingsView.swift
      - AirFit/Modules/Settings/Views/APIConfigurationView.swift
      - AirFit/Modules/Settings/Views/APIKeyEntryView.swift
      - AirFit/Modules/Settings/Views/UnitsSettingsView.swift
      - AirFit/Modules/Settings/Views/DataManagementView.swift
      - AirFit/Modules/Settings/Views/NotificationPreferencesView.swift
      - AirFit/Modules/Settings/Views/PrivacySecurityView.swift
      - AirFit/Modules/Settings/Views/AppearanceSettingsView.swift
      - AirFit/Core/Constants/AppConstants+Settings.swift
      - AirFit/Modules/FoodTracking/Services/FoodVoiceAdapter.swift
      - AirFit/Core/Protocols/FoodVoiceServiceProtocol.swift
      - AirFit/Core/Protocols/NutritionServiceProtocol.swift
      - AirFit/Modules/FoodTracking/Services/NutritionService.swift
      - AirFit/Modules/FoodTracking/Services/PreviewServices.swift
      - AirFit/Modules/FoodTracking/Models/FoodTrackingModels.swift
      - AirFit/Modules/FoodTracking/Coordinators/FoodTrackingCoordinator.swift
      - AirFit/Modules/FoodTracking/ViewModels/FoodTrackingViewModel.swift
      - AirFit/Modules/FoodTracking/Views/FoodConfirmationView.swift
      - AirFit/Modules/FoodTracking/Views/FoodLoggingView.swift
      - AirFit/Modules/FoodTracking/Views/PhotoInputView.swift
      - AirFit/Modules/FoodTracking/Views/MacroRingsView.swift
      - AirFit/Modules/FoodTracking/Views/WaterTrackingView.swift
      - AirFit/Modules/FoodTracking/Views/NutritionSearchView.swift
      # FoodTracking Module Files (CRITICAL: XcodeGen nesting bug)
      - AirFit/Modules/FoodTracking/Models/FoodTrackingModels.swift
      - AirFit/Modules/FoodTracking/ViewModels/FoodTrackingViewModel.swift
      - AirFit/Modules/FoodTracking/Views/FoodLoggingView.swift
      - AirFit/Modules/FoodTracking/Views/FoodConfirmationView.swift
      - AirFit/Modules/FoodTracking/Views/PhotoInputView.swift
      - AirFit/Modules/FoodTracking/Views/NutritionSearchView.swift
      - AirFit/Modules/FoodTracking/Views/WaterTrackingView.swift
      - AirFit/Modules/FoodTracking/Views/MacroRingsView.swift
      - AirFit/Modules/FoodTracking/Views/FoodVoiceInputView.swift
      - AirFit/Modules/FoodTracking/Services/FoodVoiceAdapter.swift
      - AirFit/Core/Protocols/FoodVoiceAdapterProtocol.swift
      - AirFit/Modules/FoodTracking/Services/NutritionService.swift
      - AirFit/Core/Protocols/NutritionServiceProtocol.swift
      - AirFit/Modules/FoodTracking/Coordinators/FoodTrackingCoordinator.swift
      # Notifications Module Files (Module 9 - CRITICAL: XcodeGen nesting bug)
      - AirFit/Modules/Notifications/Coordinators/NotificationsCoordinator.swift
      - AirFit/Modules/Notifications/Managers/NotificationManager.swift
      - AirFit/Modules/Notifications/Managers/LiveActivityManager.swift
      - AirFit/Modules/Notifications/Services/EngagementEngine.swift
      - AirFit/Modules/Notifications/Services/NotificationContentGenerator.swift
      - AirFit/Modules/Notifications/Models/NotificationModels.swift
      # Application Layer Files (CRITICAL: XcodeGen nesting bug)
      - AirFit/Application/AirFitApp.swift
      - AirFit/Application/MinimalContentView.swift
      # Asset Catalog (CRITICAL: Must be explicitly included)
      - AirFit/Assets.xcassets
      # NOTE: Original ContentView.swift and DashboardView.swift temporarily excluded due to API issues
      # These will be fixed in future modules
    resources:
      - AirFit/Assets.xcassets
      - AirFit/Resources
    settings:
      PRODUCT_BUNDLE_IDENTIFIER: com.airfit.app
      INFOPLIST_FILE: AirFit/Info.plist
      CODE_SIGN_ENTITLEMENTS: AirFit/AirFit.entitlements
      SWIFT_VERSION: "6.0"
      ENABLE_STRICT_CONCURRENCY: YES
      SWIFT_STRICT_CONCURRENCY: complete
    dependencies:
      - package: WhisperKit

  AirFitTests:
    type: bundle.unit-test
    platform: iOS
    sources:
      - path: AirFit/AirFitTests
        includes:
          - "**/*.swift"
        excludes:
          - "**/*.md"
          - "Context/ContextAssemblerTests.swift"
      # Explicit test files (CRITICAL: XcodeGen nesting bug)
      - AirFit/AirFitTests/Modules/Onboarding/OnboardingServiceTests.swift
      - AirFit/AirFitTests/Modules/Onboarding/OnboardingFlowViewTests.swift
      - AirFit/AirFitTests/Modules/Onboarding/OnboardingViewTests.swift
      - AirFit/AirFitTests/Modules/Onboarding/OnboardingViewModelTests.swift
      - AirFit/AirFitTests/Modules/Onboarding/OnboardingIntegrationTests.swift
      - AirFit/AirFitTests/Modules/Onboarding/OnboardingModelsTests.swift
      - AirFit/AirFitTests/Health/HealthKitManagerTests.swift
      - AirFit/AirFitTests/Mocks/MockHealthKitManager.swift
      - AirFit/AirFitTests/Services/NetworkManagerTests.swift
      # ServiceProtocolsTests.swift removed - protocols moved to Core/Protocols
      - AirFit/AirFitTests/Services/WeatherServiceTests.swift
      - AirFit/AirFitTests/Services/MockServicesTests.swift
      - AirFit/AirFitTests/Services/TestDataGenerators.swift
      - AirFit/AirFitTests/Services/ServicePerformanceTests.swift
      - AirFit/AirFitTests/Services/ServiceIntegrationTests.swift
      - AirFit/AirFitTests/Services/GeminiProviderTests.swift
      - AirFit/AirFitTests/Mocks/MockHealthKitPrefillProvider.swift
      - AirFit/AirFitTests/Mocks/MockDashboardServices.swift
      - AirFit/AirFitTests/Mocks/MockVoiceInputManager.swift
      - AirFit/AirFitTests/Mocks/MockVoiceServices.swift
      - AirFit/AirFitTests/Modules/AI/LocalCommandParserTests.swift
      - AirFit/AirFitTests/Modules/AI/FunctionCallDispatcherTests.swift
      - AirFit/AirFitTests/Modules/AI/CoachEngineTests.swift
      - AirFit/AirFitTests/Modules/AI/PersonaEngineTests.swift
      - AirFit/AirFitTests/Modules/AI/PersonaEnginePerformanceTests.swift  # Phase 4: Performance validation
      - AirFit/AirFitTests/Modules/AI/ConversationManagerTests.swift
      - AirFit/AirFitTests/Modules/AI/ConversationManagerPersistenceTests.swift
      - AirFit/AirFitTests/Modules/AI/ConversationManagerPerformanceTests.swift
      - AirFit/AirFitTests/Modules/AI/MessageClassificationTests.swift
      - AirFit/AirFitTests/Modules/AI/Phase2ValidationTests.swift  # Phase 2: Database optimization validation
      - AirFit/AirFitTests/AI/ContextAnalyzerTests.swift
      - AirFit/AirFitTests/Performance/DirectAIPerformanceTests.swift
      - AirFit/AirFitTests/Services/WorkoutSyncServiceTests.swift
      - AirFit/AirFitTests/Workouts/WorkoutViewModelTests.swift
      - AirFit/AirFitTests/Workouts/WorkoutCoordinatorTests.swift
      - AirFit/AirFitTests/Modules/Chat/ChatCoordinatorTests.swift
      - AirFit/AirFitTests/Modules/Chat/ChatSuggestionsEngineTests.swift
      - AirFit/AirFitTests/Modules/Chat/ChatViewModelTests.swift
      - AirFit/AirFitTests/Core/VoiceInputManagerTests.swift
      - AirFit/AirFitTests/Modules/Dashboard/DashboardViewModelTests.swift
      - AirFit/AirFitTests/FoodTracking/FoodTrackingViewModelTests.swift # Added
      - AirFit/AirFitTests/FoodTracking/FoodVoiceAdapterTests.swift # Existing, ensure it's here
      # NEW TASK 6 TEST FILES (CRITICAL: Add for comprehensive test coverage)
      - AirFit/AirFitTests/FoodTracking/NutritionParsingExtensiveTests.swift
      - AirFit/AirFitTests/FoodTracking/FoodTrackingViewModelAIIntegrationTests.swift
      - AirFit/AirFitTests/FoodTracking/AINutritionParsingIntegrationTests.swift
      - AirFit/AirFitTests/FoodTracking/AINutritionParsingTests.swift
      # TASK 7 PERFORMANCE & REGRESSION TEST FILES (CRITICAL: Phase 1 Task 7)
      - AirFit/AirFitTests/Performance/NutritionParsingPerformanceTests.swift
      - AirFit/AirFitTests/Performance/NutritionParsingRegressionTests.swift
      # TASK 8 FINAL INTEGRATION TEST FILE (CRITICAL: Phase 1 Task 8 - Final Validation)
      - AirFit/AirFitTests/FoodTracking/NutritionParsingFinalIntegrationTests.swift
      - AirFit/AirFitTests/Integration/NutritionParsingIntegrationTests.swift
      - AirFit/AirFitTests/Integration/PersonaSystemIntegrationTests.swift
      - AirFit/AirFitTests/Integration/OnboardingFlowTests.swift
      - AirFit/AirFitTests/Integration/PersonaGenerationTests.swift
      - AirFit/AirFitTests/Integration/OnboardingErrorRecoveryTests.swift  # Phase 4: Error handling tests
      # Phase 3 Performance Tests
      - AirFit/AirFitTests/Performance/PersonaGenerationStressTests.swift
      - AirFit/AirFitTests/Mocks/MockAIService.swift
      - AirFit/AirFitTests/Mocks/MockOnboardingService.swift
      - AirFit/AirFitTests/Mocks/MockWhisperServiceWrapper.swift
      - AirFit/AirFitTests/Mocks/MockAIAPIService.swift
      - AirFit/AirFitTests/Mocks/MockAIFunctionServices.swift
      - AirFit/AirFitTests/Mocks/MockLLMOrchestrator.swift
      # Module 9 Test Files
      - AirFit/AirFitTests/Modules/Notifications/NotificationManagerTests.swift
      - AirFit/AirFitTests/Modules/Notifications/EngagementEngineTests.swift
      # Module 11 Test Files
      - AirFit/AirFitTests/Modules/Settings/SettingsViewModelTests.swift
      - AirFit/AirFitTests/Modules/Settings/BiometricAuthManagerTests.swift
      - AirFit/AirFitTests/Modules/Settings/SettingsModelsTests.swift
      - AirFit/AirFitTests/Mocks/MockNotificationManager.swift
    dependencies:
      - target: AirFit
    settings:
      BUNDLE_LOADER: $(TEST_HOST)
      TEST_HOST: $(BUILT_PRODUCTS_DIR)/AirFit.app/AirFit
      GENERATE_INFOPLIST_FILE: YES
      SWIFT_VERSION: "6.0"
      ENABLE_STRICT_CONCURRENCY: YES
      SWIFT_STRICT_CONCURRENCY: complete

  AirFitUITests:
    type: bundle.ui-testing
    platform: iOS
    sources:
      - path: AirFit/AirFitUITests
        includes:
          - "**/*.swift"
        excludes:
          - "**/*.md"
          - "FoodTracking/FoodTrackingFlowUITests.swift"  # Temporarily excluded due to Swift 6 concurrency issues
      # Explicit UI test files (CRITICAL: XcodeGen nesting bug)
      - AirFit/AirFitUITests/Dashboard/DashboardUITests.swift
      # - AirFit/AirFitUITests/FoodTracking/FoodTrackingFlowUITests.swift # Temporarily disabled
    dependencies:
      - target: AirFit
    settings:
      TEST_TARGET_NAME: AirFit
      GENERATE_INFOPLIST_FILE: YES
      SWIFT_VERSION: "6.0"
      ENABLE_STRICT_CONCURRENCY: YES
      SWIFT_STRICT_CONCURRENCY: complete

  AirFitWatchApp:
    type: application
    platform: watchOS
    sources:
      # Watch App Files (CRITICAL: XcodeGen nesting bug)
      - AirFitWatchApp/AirFitWatchApp.swift
      - AirFitWatchApp/Services/WatchWorkoutManager.swift
      - AirFitWatchApp/Views/WorkoutStartView.swift
      - AirFitWatchApp/Views/ActiveWorkoutView.swift
      - AirFitWatchApp/Views/ExerciseLoggingView.swift
      # Shared Core Files needed by Watch
      - AirFit/Core/Extensions/Double+Extensions.swift
      - AirFit/Core/Extensions/TimeInterval+Extensions.swift
      - AirFit/Core/Models/WorkoutBuilderData.swift
      - AirFit/Core/Utilities/AppLogger.swift
    settings:
      PRODUCT_BUNDLE_IDENTIFIER: com.airfit.watchapp
      GENERATE_INFOPLIST_FILE: YES
      SWIFT_VERSION: "6.0"
      WATCHOS_DEPLOYMENT_TARGET: "11.0"
      ENABLE_STRICT_CONCURRENCY: YES
      SWIFT_STRICT_CONCURRENCY: complete
    dependencies:
      - target: AirFit

  AirFitWatchAppTests:
    type: bundle.unit-test
    platform: watchOS
    sources:
      - AirFitWatchApp/AirFitWatchAppTests/Services/WatchWorkoutManagerTests.swift
    dependencies:
      - target: AirFitWatchApp
    settings:
      PRODUCT_BUNDLE_IDENTIFIER: com.airfit.watchapp.tests
      GENERATE_INFOPLIST_FILE: YES
      SWIFT_VERSION: "6.0"
      ENABLE_TESTING_SEARCH_PATHS: YES
      ENABLE_STRICT_CONCURRENCY: YES
      SWIFT_STRICT_CONCURRENCY: complete

schemes:
  AirFit:
    build:
      targets:
        AirFit: all
        AirFitTests: [test]
        AirFitUITests: [test]
        AirFitWatchApp: all
    run:
      config: Debug
    test:
      config: Debug
      targets:
        - AirFitTests
        - AirFitUITests
    profile:
      config: Release
    analyze:
      config: Debug
    archive:
      config: Release

  AirFitWatchApp:
    build:
      targets:
        AirFitWatchApp: all
    run:
      config: Debug
    test:
      config: Debug
    profile:
      config: Release
    analyze:
      config: Debug
    archive:
      config: Release
